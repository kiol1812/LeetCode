# Maximum Number of Points From Grid Queries
- Difficulty: Hard
- Topics: `Array` `Two Pointers` `Breadth-First Search` `Union Find` `Sorting` `Heap (Priority Queue)` `Matrix`

<!-- ## Data Structure
``` cpp
``` -->

## Solution
Solved without hints.ğŸ‰  
è§£é¡Œéç¨‹ï¼š
1. ç¬¬ä¸€å€‹å¿µé ­æ˜¯åªè¦æª¢æŸ¥ç•¶ä¸‹æ ¼å­çš„å³æ–¹å’Œä¸‹æ–¹ï¼Œé€™æ¨£å¯ä»¥æ¸›å°‘è¦è™•ç†çš„æ•¸é‡ã€‚ä¸éé€™å€‹æƒ³æ³•ä¸¦éæ­£ç¢ºçš„ï¼Œè€ƒæ…®ç¯„ä¾‹ï¼š
    ```plain
    1 1 1
    2 2 1
    1 1 1
    ```
2. ç´€éŒ„æŸæ•¸å¯ä»¥ç¢°åˆ°å“ªäº›æ ¼å­ï¼Œä»¥ç¯„ä¾‹ä¸€è¼¸å…¥ä½œç‚ºèªªæ˜ï¼š  
    é¦–å…ˆqueries[0]ç‚º5ï¼Œå¾—åˆ°åˆ†æ•¸5ï¼Œå¯ä»¥æ¥è§¸åˆ°çš„æœ‰{5, 5, 7}ä¸‰æ ¼ï¼Œä¹‹å¾Œåªè¦åˆ¤æ–·queries[i]æ˜¯å¦å¤§æ–¼5ï¼Œå†åˆ¤æ–·{5, 5, 7}ä¸‰æ ¼(æ‡‰è©²æ˜¯priority_queue)ã€‚
3. ä½†å¦‚æœqueries[i]è¼ƒä¸Šæ¬¡å°ï¼Œå¯èƒ½æœƒæœ‰å•é¡Œï¼Œæ‡‰è©²æ˜¯æ¨™ç±¤è£¡çš„sortingç¯„ç–‡ï¼Œåªè¦å…ˆå°‡queriesç¶“éæ’åºï¼Œä¸ä½†å¯ä»¥è§£æ±ºå•é¡Œï¼Œé‚„å¯ä»¥å»é™¤é‡è¤‡è¨ˆç®—ã€‚  

å¡ä½çš„åœ°æ–¹ï¼š
1. é‚„æ²’è¨˜ä½è¦åŠ ä¸Š`decltype`å’Œå¾Œé¢surface(cmp)è¦åŠ å…¥`(cmp)`ã€‚
    ```cpp
    priority_queue<pair<int, int>, vector<pair<int, int>>, decltype(cmp)> surface(cmp);
    ```
2. priority_queueå¸ƒæ—é‚è¼¯è¦åéä¾†ï¼Œæ”¾`>`æ‰æ˜¯`minheap`
    ```cpp
    auto cmp = [&](const pair<int, int> &a, const pair<int, int> &b){
        return grid[a.first][a.second]>grid[b.first][b.second];
    };
    ```
        
- runtime beats 38.04% ğŸ¥²
- memory beats 54.35%
``` cpp
class Solution {
public:
    vector<int> maxPoints(vector<vector<int>>& grid, vector<int>& queries) {
        int n=grid.size(), m=grid[0].size(), pre=0; //preç”¨ä¾†è¨˜ordered_queries[now-1]çš„åˆ†æ•¸
        vector<vector<bool>> visited(n, vector<bool>(m, false)); // visitedè®Šæ•¸å‘½åä¸æ˜¯å¾ˆç²¾ç¢ºï¼Œé€™é‚Šæ˜¯ç´€éŒ„æ˜¯å¦å·²åŠ å…¥(é)surfaceä¸­
        unordered_map<int, int> res_mp;
        set<int> ordered_queries;
        int d[5] = {1, 0, -1, 0, 1};
        auto cmp = [&](const pair<int, int> &a, const pair<int, int> &b){
            return grid[a.first][a.second]>grid[b.first][b.second]; //priority_queueå¸ƒæ—é‚è¼¯è¦åéä¾†
        };
        priority_queue<pair<int, int>, vector<pair<int, int>>, decltype(cmp)> surface(cmp); //å¯ä»¥æ¥è§¸çš„ç¯€é»ï¼Œå­˜(y, x)ã€‚ä½¿ç”¨çš„minheapçš„åŸºæº–æ˜¯grid(å¤–éƒ¨)ã€‚
        surface.push({0, 0}); 
        visited[0][0]=true;
        for (int &query:queries) ordered_queries.insert(query);
        for (auto &it:ordered_queries) {
            while (!surface.empty() && grid[surface.top().first][surface.top().second] < it) {
                auto [y, x] = surface.top();
                surface.pop();
                ++pre;
                for (int i=0; i<4; ++i) {
                    int ny=y+d[i], nx=x+d[i+1];
                    if (ny>=0&&nx>=0&&ny<n&&nx<m) {
                        if (!visited[ny][nx]) {
                            visited[ny][nx] = true;
                            surface.push({ny, nx});
                        }
                    }
                }
            }
            res_mp[it] = pre;
        }
        for (int &query:queries) query=res_mp[query]; //çœç©ºé–“
        return queries;
    }
};
```
<!-- - runtime beats 
- memory beats 
```rust
``` -->

<!-- ## Improving
### source code
- runtime beats 
- memory beats 
``` cpp
``` -->
<!-- - runtime beats 
- memory beats 
```rust
``` -->